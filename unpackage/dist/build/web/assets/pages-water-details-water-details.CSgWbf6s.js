import{T as t,v as e,U as s,p as a,t as r,e as n,b as o,w as i,H as l,F as c,x as d,l as u,a as g}from"./index-DD8SDI5w.js";import{_ as h}from"./background.9mxQRA6f.js";import{_ as p}from"./_plugin-vue_export-helper.BCo6x5W8.js";const f=p({data(){return{totalCups:4,cupSizeMl:400,currentCups:0,todayRecord:[],selectedDate:this.formatDate(new Date),intakeId:null}},setup:()=>({store:t()}),computed:{remainingCups(){return this.totalCups-this.currentCups},remainingMl(){return this.remainingCups*this.cupSizeMl},progress(){return(this.currentCups/this.totalCups*100).toFixed(0)}},mounted(){this.checkDateAndReset(),this.dateWatcher=setInterval((()=>{this.checkDateAndReset()}),6e4)},beforeUnmount(){clearInterval(this.dateWatcher)},methods:{formatDate:t=>t.toISOString().split("T")[0],checkDateAndReset(){const t=this.formatDate(new Date);this.selectedDate!==t&&(this.selectedDate=t,this.currentCups=0,this.todayRecord=[],this.createDailyRecord()),this.loadWaterRecords()},async loadWaterRecords(){const t=this.$store.state.userId,e=this.$store.state.access_token;if(t&&e)try{const s=await fetch(`http://129.204.151.245:5001/user/${t}/intake/date/${this.selectedDate}`,{method:"GET",headers:{Authorization:`Bearer ${e}`}});if(s.ok){const t=await s.json();this.intakeId=t.intake_id,this.currentCups=t.have_drink?t.have_drink.length:0,this.todayRecord=t.have_drink||[]}else 404===s.status?await this.createDailyRecord():alert("加载饮水记录失败，请稍后重试！")}catch(s){console.error("加载饮水记录出错：",s),alert("加载饮水记录失败，请检查网络连接！")}else alert("请先登录！")},async createDailyRecord(){const t=this.$store.state.userId,e=this.$store.state.access_token;if(!t||!e)return void alert("请先登录！");const s={date:this.selectedDate,eat_target:0,breakfast:[],lunch:[],dinner:[],more:[],have_eat:[],drink_target:0,have_drink:[]};try{const a=await fetch(`http://129.204.151.245:5001/user/${t}/intake`,{method:"POST",headers:{"Content-Type":"application/json",Authorization:`Bearer ${e}`},body:JSON.stringify(s)});if(a.ok){const t=await a.json();this.intakeId=t.intake_id,alert("今日记录已创建！")}else alert("创建今日记录失败，请稍后重试！")}catch(a){console.error("创建今日记录出错：",a),alert("创建今日记录失败，请检查网络连接！")}},async addWater(){const t=this.$store.state.userId,e=this.$store.state.access_token;if(t&&e)if(this.intakeId)if(this.currentCups<this.totalCups){const a=(new Date).toISOString();this.currentCups++,this.todayRecord.push({timestamp:a});const r={date:this.selectedDate,drink_target:this.totalCups*this.cupSizeMl,have_drink:this.todayRecord};try{(await fetch(`http://129.204.151.245:5001/user/${t}/intake/${this.intakeId}`,{method:"PUT",headers:{"Content-Type":"application/json",Authorization:`Bearer ${e}`},body:JSON.stringify(r)})).ok?alert("饮水记录更新成功！"):alert("饮水记录更新失败，请稍后重试！")}catch(s){console.error("更新饮水记录出错：",s),alert("更新饮水记录失败，请检查网络连接！")}}else alert("今日饮水目标已达成！");else alert("记录尚未加载，请稍后重试！");else alert("请先登录！")},formatTime(t){const e=new Date(t);return`${e.getHours()}:${e.getMinutes()}:${e.getSeconds()}`}}},[["render",function(t,p,f,A,m,y){const k=u;return g(),e("div",{class:"water-tracker"},[s("div",{class:"main-image"},[s("img",{src:h,alt:"logo",class:"background-image"})]),s("div",{class:"header"},[s("h2",null,"今日饮水记录")]),s("div",{class:"progress"},[s("div",{class:"progress-bar",style:a({width:y.progress+"%"})},[s("span",null,r(y.progress)+"%",1)],4)]),s("div",{class:"cup"},[s("img",{src:"data:image/png;base64,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",alt:"cup"})]),s("div",{class:"info"},[s("p",null,[n("今天，再喝 "),s("strong",null,r(y.remainingCups),1),n(" 杯 ("),s("strong",null,r(y.remainingMl),1),n(" ml)")]),s("p",null,[n("今日目标: "),s("strong",null,r(m.totalCups),1),n(" 杯 ("),s("strong",null,r(m.totalCups*m.cupSizeMl),1),n(" ml)")]),s("p",null,[n("水杯容量: "),s("strong",null,r(m.cupSizeMl),1),n(" ml")])]),o(k,{onClick:y.addWater,disabled:m.currentCups>=m.totalCups,class:"add-water-btn"},{default:i((()=>[n(r(m.currentCups<m.totalCups?"加一杯水":"目标已达成！"),1)])),_:1},8,["onClick","disabled"]),s("div",{class:"records"},[s("h3",{class:"title"},"喝水记录"),m.currentCups<m.totalCups?(g(),e("p",{key:0},"今天水还没喝够呢，再来一杯吧～")):l("",!0),s("ul",null,[(g(!0),e(c,null,d(m.todayRecord,((t,s)=>(g(),e("li",{key:s}," 第"+r(s+1)+"杯水: "+r(y.formatTime(t.timestamp)),1)))),128))])])])}],["__scopeId","data-v-d62c99c7"]]);export{f as default};
