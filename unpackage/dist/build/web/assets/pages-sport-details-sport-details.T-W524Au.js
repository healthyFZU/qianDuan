import{T as e,v as s,U as t,t as r,b as o,w as a,F as i,x as c,H as l,f as n,l as d,a as u,e as m}from"./index-DD8SDI5w.js";import{a as h}from"./axios.CCYSaZn9.js";import{_ as p}from"./background.9mxQRA6f.js";import{_ as y}from"./_plugin-vue_export-helper.BCo6x5W8.js";const f=y({data(){return{caloriesBurned:0,showHistory:!1,historyRecords:[],exercises:[{id:1,name:"ç‘œä¼½ä¼¸å±•è¯¾ç¨‹",description:"ç¬¬ä¸€è¯¾ | å…¥é—¨ç‘œä¼½ä¼¸å±•",time:6,calories:29},{id:2,name:"åˆçº§æ‹³å‡»è¯¾ç¨‹",description:"ç¬¬ä¸€è¯¾ | ç‡ƒè„‚æ‹³å‡»åˆçº§",time:7,calories:141}],selectedDate:this.formatDate(new Date),measurementId:null,userId:null,accessToken:null}},setup:()=>({store:e()}),mounted(){this.checkDateAndReset(),this.loadExerciseRecords()},methods:{formatDate:e=>e.toISOString().split("T")[0],checkDateAndReset(){const e=localStorage.getItem("lastRecordedDate"),s=this.formatDate(new Date);e!==s?(this.caloriesBurned=0,this.historyRecords=[],this.measurementId=null,localStorage.setItem("lastRecordedDate",s),localStorage.setItem("caloriesBurned",0),console.log("æ–°çš„ä¸€å¤©ï¼Œåˆ›å»ºåˆå§‹è®°å½•...")):(this.caloriesBurned=parseInt(localStorage.getItem("caloriesBurned"))||0,console.log(`åŠ è½½å½“å¤©çš„æ€»çƒ­é‡ï¼š${this.caloriesBurned}`),this.loadExerciseRecords())},saveCalories(){localStorage.setItem("caloriesBurned",this.caloriesBurned),console.log(`ä¿å­˜çƒ­é‡åˆ° localStorageï¼š${this.caloriesBurned}`)},async loadExerciseRecords(){const e=this.$store.state.userId,s=this.$store.state.access_token;if(!e||!s)return alert("è¯·å…ˆç™»å½•ï¼"),void this.$router.push("/pages/login/login");const t=this.selectedDate;try{const r=await h.get(`http://localhost:5000/sports/user/${e}/sports`,{params:{date:t},headers:{Authorization:`Bearer ${s}`}});if(200===r.status){const{sports:e,total_calories:s}=r.data;this.historyRecords=e.map((e=>({id:e.measurement_id,date:e.created_at,name:e.name,calories:e.calories}))),this.caloriesBurned=s}else console.error("åŠ è½½è¿åŠ¨è®°å½•å¤±è´¥")}catch(r){console.error("åŠ è½½è¿åŠ¨è®°å½•å‡ºé”™ï¼š",r),alert("åŠ è½½è¿åŠ¨è®°å½•å¤±è´¥ï¼Œè¯·æ£€æŸ¥ç½‘ç»œè¿æ¥ï¼")}},async createInitialRecord(){const e=this.$store.state.userId,s=this.$store.state.access_token;if(!e||!s)return alert("è¯·å…ˆç™»å½•ï¼"),!1;try{const t=await fetch(`http://127.0.0.1:5000/sports/user/${e}/sports`,{method:"POST",headers:{"Content-Type":"application/json",Authorization:`Bearer ${s}`},body:JSON.stringify({sports:{name:"åˆå§‹è®°å½•",calories:0}})});if(t.ok){const e=await t.json();return this.measurementId=e.measurement_id,console.log("åˆå§‹è®°å½•åˆ›å»ºæˆåŠŸï¼š",e),!0}{const e=await t.json();return console.error("åˆ›å»ºåˆå§‹è®°å½•å¤±è´¥ï¼š",e),!1}}catch(t){return console.error("åˆ›å»ºåˆå§‹è®°å½•å¤±è´¥ï¼š",t),!1}},async recordExercise(){const e=this.$store.state.userId,s=this.$store.state.access_token;if(!e||!s)return void alert("è¯·å…ˆç™»å½•ï¼");const t=prompt("è¯·è¾“å…¥æ¶ˆè€—çš„çƒ­é‡ (åƒå¡):","50");if(!/^\d+$/.test(t))return void alert("è¯·è¾“å…¥ä¸€ä¸ªæœ‰æ•ˆçš„æ­£æ•´æ•°å€¼ï¼");const r={name:"è‡ªå®šä¹‰è¿åŠ¨",calories:parseInt(t)};try{const t=await h.post(`http://localhost:5000/api/sports/user/${e}`,{sports:r},{headers:{Authorization:`Bearer ${s}`}});201===t.status?(this.historyRecords.push({id:t.data.measurement_id,date:this.selectedDate,name:r.name,calories:r.calories}),this.caloriesBurned+=r.calories,console.log("å·²è®°å½•è¿åŠ¨ï¼š",r),alert(`å·²è®°å½• ${r.name} çš„è¿åŠ¨ï¼Œæ¶ˆè€— ${r.calories} åƒå¡ï¼`)):(console.error("æ·»åŠ è¿åŠ¨è®°å½•å¤±è´¥"),alert("è®°å½•è¿åŠ¨å¤±è´¥ï¼Œè¯·ç¨åé‡è¯•ï¼"))}catch(o){console.error("è®°å½•è¿åŠ¨å‡ºé”™ï¼š",o),alert("è®°å½•è¿åŠ¨å¤±è´¥ï¼Œè¯·æ£€æŸ¥ç½‘ç»œè¿æ¥ï¼")}},toggleHistory(){this.showHistory=!this.showHistory},async recordSpecificExercise(e){const s=this.$store.state.userId,t=this.$store.state.access_token;if(s&&t)try{if(!this.measurementId){const e=await h.post(`http://127.0.0.1:5000/sports/user/${s}/sports`,{sports:{name:"åˆå§‹è®°å½•",calories:0}},{headers:{"Content-Type":"application/json",Authorization:`Bearer ${t}`}});if(201!==e.status)return console.error("åˆ›å»ºåˆå§‹è®°å½•å¤±è´¥"),void alert("æ— æ³•åˆ›å»ºåˆå§‹è®°å½•ï¼");this.measurementId=e.data.measurement_id,console.log("åˆ›å»ºæ–°çš„è®°å½• IDï¼š",this.measurementId)}200===(await h.put(`http://127.0.0.1:5000/sports/user/${s}/sports/${this.measurementId}`,{sports:{name:e.name,calories:e.calories}},{headers:{"Content-Type":"application/json",Authorization:`Bearer ${t}`}})).status?(this.historyRecords.push({id:this.measurementId,date:this.selectedDate,name:e.name,calories:e.calories}),this.caloriesBurned+=e.calories,console.log("è®°å½•è¿åŠ¨æˆåŠŸï¼š",e),alert(`å·²è®°å½• ${e.name} çš„è¿åŠ¨ï¼Œæ¶ˆè€— ${e.calories} åƒå¡ï¼`)):(console.error("è®°å½•è¿åŠ¨å¤±è´¥"),alert("è®°å½•è¿åŠ¨å¤±è´¥ï¼Œè¯·ç¨åé‡è¯•ï¼"))}catch(r){console.error("è®°å½•è¿åŠ¨å‡ºé”™ï¼š",r),alert("è®°å½•è¿åŠ¨å¤±è´¥ï¼Œè¯·æ£€æŸ¥ç½‘ç»œè¿æ¥ï¼")}else alert("è¯·å…ˆç™»å½•ï¼")},updateRecommendations(){this.exercises=[{id:3,name:"è·‘æ­¥",description:"æœ‰æ°§è·‘æ­¥è®­ç»ƒ",time:30,calories:250},{id:4,name:"é«˜å¼ºåº¦é—´æ­‡è®­ç»ƒ",description:"ç‡ƒè„‚ HIIT è®­ç»ƒ",time:20,calories:300}],alert("æ¨èè¿åŠ¨å·²æ›´æ–°ï¼")}}},[["render",function(e,h,y,f,g,$){const I=n,k=d;return u(),s("div",{class:"exercise-record"},[t("div",{class:"main-image"},[t("img",{src:p,alt:"logo",class:"background-image"})]),t("header",{class:"header"}),t("section",{class:"today-summary"},[t("div",{class:"date-section"},[t("h3",null,r(g.selectedDate),1),o(I,{onClick:$.toggleHistory},{default:a((()=>[m("ğŸ“…")])),_:1},8,["onClick"])]),t("div",{class:"summary-info"},[t("div",{class:"today-exercise"},[t("p",null,"ä»Šæ—¥è¿åŠ¨"),o(k,{class:"button1",onClick:$.recordExercise},{default:a((()=>[m("+")])),_:1},8,["onClick"])]),t("div",{class:"calories"},[t("p",null,"çƒ­é‡æ¶ˆè€—"),t("p",null,r(g.caloriesBurned)+" åƒå¡",1)])]),t("p",{class:"tip"}," æ¸©é¦¨æç¤ºï¼šåˆç†å®‰æ’é¥®é£Ÿå’Œè¿åŠ¨æ—¶é—´ã€‚å»ºè®®é¥­å2å°æ—¶åè¿åŠ¨ï¼Œè¿åŠ¨ç»“æŸ1å°æ—¶åå†è¿›é£Ÿã€‚ ")]),g.showHistory?(u(),s("section",{key:0,class:"history-records"},[o(I,{style:{"font-size":"18px"}},{default:a((()=>[m("å†å²è¿åŠ¨è®°å½•")])),_:1}),t("ul",null,[(u(!0),s(i,null,c(g.historyRecords,((e,t)=>(u(),s("li",{key:e.id},r(e.date)+" - "+r(e.name)+" - "+r(e.calories)+" åƒå¡ ",1)))),128))])])):l("",!0),t("section",{class:"recommended-exercises"},[o(I,{style:{"font-size":"18px"}},{default:a((()=>[m("æ¨èè¿åŠ¨")])),_:1}),(u(!0),s(i,null,c(g.exercises,(e=>(u(),s("div",{key:e.id,class:"exercise-card"},[t("p",null,r(e.name),1),t("p",null,r(e.description),1),t("p",null,r(e.time)+" åˆ†é’Ÿ - "+r(e.calories)+" åƒå¡",1),o(k,{class:"button2",onClick:s=>$.recordSpecificExercise(e)},{default:a((()=>[m("+")])),_:2},1032,["onClick"])])))),128)),o(I,{onClick:$.updateRecommendations,style:{display:"block","margin-left":"120px",cursor:"pointer"}},{default:a((()=>[m("ğŸ”„ æ¢ä¸€ä¸‹")])),_:1},8,["onClick"])])])}],["__scopeId","data-v-448c1931"]]);export{f as default};
