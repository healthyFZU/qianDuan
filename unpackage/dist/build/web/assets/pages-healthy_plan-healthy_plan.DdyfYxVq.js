import{T as e,W as a,R as s,v as l,U as t,H as n,F as c,x as i,b as o,w as r,t as u,l as v,f as p,a as d,e as h}from"./index-DD8SDI5w.js";import{_ as f}from"./捂嘴.BnetWn1a.js";import{_ as k}from"./_plugin-vue_export-helper.BCo6x5W8.js";const _=k({setup(){const l=e(),t=a((()=>l.state.userId)),n=a((()=>l.state.favoritePlans||[])),c=s(""),i=s(!1),o=s(!1);console.log(t.value);return{userId:t,favoritePlans:n,planResult:c,saveSuccess:i,noPlan:o,generatePlan:()=>{t.value&&!isNaN(t.value)?fetch("http://129.204.151.245:5004/make_plan",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({user_id:t.value})}).then((e=>e.json())).then((e=>{e.weekly_plan?(c.value=e.weekly_plan,o.value=!1):alert("未能生成健康计划，错误信息："+(e.error||"未知错误"))})).catch((e=>{alert("请求失败: "+e.message)})):alert("未能获取有效的用户ID")},savePlan:()=>{c.value?fetch("http://129.204.151.245:5003/save_plan",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({user_id:t.value,context:c.value})}).then((e=>e.json())).then((e=>{e.success?(i.value=!0,setTimeout((()=>{i.value=!1}),2e3)):alert("保存失败，错误信息："+(e.error||"未知错误"))})).catch((e=>{alert("请求失败: "+e.message)})):alert("请先生成健康计划")},cancelPlan:()=>{c.value=""},viewPlan:()=>{fetch(`http://129.204.151.245:5005/get_plan?user_id=${t.value}`).then((e=>e.json())).then((e=>{e.plan?(c.value=e.plan,o.value=!1):o.value=!0})).catch((e=>{alert("请求失败: "+e.message)}))}}}},[["render",function(e,a,s,k,_,m){const y=v,P=p;return d(),l("div",{class:"favorites-page"},[t("div",{class:"favorites-list"},[k.noPlan?(d(),l("div",{key:0,class:"no-plan"},[t("p",null,"您还没有生成任何计划")])):n("",!0),0!==k.favoritePlans.length||k.planResult?(d(),l("div",{key:2},[(d(!0),l(c,null,i(k.favoritePlans,(e=>(d(),l("div",{class:"favorite-item",key:e.id},[t("div",{class:"plan-details"},[t("h4",{class:"plan-title"},u(e.title),1),t("p",{class:"plan-description"},u(e.description),1)])])))),128))])):(d(),l("div",{key:1,class:"empty-state"},[t("img",{src:f,alt:"暂无收藏"})]))]),k.planResult?n("",!0):(d(),l("div",{key:0,class:"create-plan-section"},[o(y,{onClick:k.viewPlan,class:"view-button"},{default:r((()=>[h("查看健康计划")])),_:1},8,["onClick"]),o(P,{onClick:k.generatePlan,class:"generate-button"},{default:r((()=>[h("--立即生成--")])),_:1},8,["onClick"])])),k.planResult?(d(),l("div",{key:1,class:"result"},[t("h4",null,"一周健康计划推荐："),t("pre",null,u(k.planResult),1),t("div",{class:"result-buttons"},[o(y,{onClick:k.savePlan,class:"save-button"},{default:r((()=>[h("保存")])),_:1},8,["onClick"]),o(y,{onClick:k.cancelPlan,class:"cancel-button"},{default:r((()=>[h("取消")])),_:1},8,["onClick"])])])):n("",!0),k.saveSuccess?(d(),l("div",{key:2,class:"save-success"},[t("p",null,"健康计划已成功保存！")])):n("",!0)])}],["__scopeId","data-v-6005b4b4"]]);export{_ as default};
