import{T as a,R as e,Z as s,o as l,v as t,U as i,b as r,w as o,t as n,H as c,e as u,F as d,x as v,V as p,n as g,I as m,l as h,a as w}from"./index-DD8SDI5w.js";import{_ as f}from"./background.9mxQRA6f.js";import{a as _}from"./axios.CCYSaZn9.js";import{_ as k}from"./_plugin-vue_export-helper.BCo6x5W8.js";const y=k({__name:"record",setup(k){const y=a(),x=e(y.state.userId),b=e(y.state.access_token),V=e(y.state.avatar_url),j=s(),C=e(0),T=e(0),I=e(0),A=e(0);e(""),e(0);const U=e(""),q=e("");e(""),e([]),e(0);const F=e([{title:"体重",updateTime:"",info:"",route:"/pages/weight-details/weight-details"},{title:"喝水记录",updateTime:"",info:"",route:"/pages/water-details/water-details"},{title:"围度",updateTime:"",info:"",route:"/pages/waist-details/waist-details"}]);async function $(){if(!x.value||!b.value)return alert("请先登录！"),void j.push("/pages/login/login");await async function(){try{const a=(await _.get(`http://129.204.151.245:5001/user/${x.value}/body-info`,{headers:{"Content-Type":"application/json",Authorization:`Bearer ${b.value}`}})).data;T.value=a.weight,I.value=a.weight_target,C.value=a.weight,A.value=(T.value-C.value).toFixed(2)}catch(a){console.error("加载用户身体信息失败:",a),alert("无法加载用户信息，请稍后重试！")}}()}function z(){p({url:"/pages/me/me"})}async function B(){if(U.value)try{const a=await _.post("http://129.204.151.245:5002/ask_question",{user_id:x.value,question:U.value});if(a.data.error)throw new Error(a.data.error);q.value=a.data.answer||"未获取到回答，请稍后重试"}catch(a){console.error("请求 AI 接口失败:",a),q.value="无法获取答案，请稍后再试。"}else alert("请输入问题")}return l((async()=>{if(!x.value||!b.value)return alert("请先登录！"),void j.push("/pages/login/login");await $()})),(a,e)=>{const s=m,l=h;return w(),t("div",{class:"record-page"},[i("div",{class:"main-image"},[i("img",{src:f,alt:"logo",class:"background-image"})]),i("div",{class:"header"},[i("img",{src:V.value||"/pages/images/logo-black.jpg",alt:"avatar",class:"avatar",onClick:z},null,8,["src"]),i("div",{class:"search-bar"},[r(s,{type:"text",class:"search-input",modelValue:U.value,"onUpdate:modelValue":e[0]||(e[0]=a=>U.value=a),placeholder:"请输入您的问题"},null,8,["modelValue"]),r(l,{class:"search-button",onClick:B},{default:o((()=>[u("搜索")])),_:1})])]),q.value?(w(),t("div",{key:0,class:"ai-response"},[i("h3",null,"AI 回答:"),i("p",null,n(q.value),1)])):c("",!0),i("div",{class:"section-title"},"体重管理"),i("div",{class:"weight-management"},[i("div",{class:"weight-info"},[i("span",null,"目标: "+n(I.value)+" 公斤",1)]),r(s,{type:"range",min:T.value,max:I.value,modelValue:C.value,"onUpdate:modelValue":e[1]||(e[1]=a=>C.value=a),class:"weight-slider"},null,8,["min","max","modelValue"]),i("div",{class:"weight-labels"},[i("span",null,"当前: "+n(C.value)+"公斤",1)])]),i("div",{class:"section-title"},"健康记录"),i("div",{class:"card",onClick:e[2]||(e[2]=a=>{g({url:"/pages/calorie-details/calorie-details"})})},[i("div",{class:"card-header"},[u(" 🔆 "),i("span",{class:"record-title"},"️热量记录"),i("span",{class:"record-time"},"更新于 上次")]),i("div",{class:"card-content"},[i("span",null,"--点击查看--")])]),i("div",{class:"record-cards"},[(w(!0),t(d,null,v(F.value,(a=>(w(),t("div",{key:a.title,class:"card",onClick:e=>{return s=a.route,void g({url:s});var s}},[i("div",{class:"card-header"},[u(" 🔆 "),i("span",{class:"record-title"},n(a.title),1),i("span",{class:"record-time"},n(a.updateTime),1)]),i("div",{class:"card-content"},"--点击查看--")],8,["onClick"])))),128))])])}}},[["__scopeId","data-v-d6a7925d"]]);export{y as default};
